<%inherit file="base.tpl"/>

<%block name="title">
Scientific Computing Group | Courses
</%block>

<%block name="content">
<%
SOURCES.insert(0, ("data", "courses.yml"))

import re
couresinit = ['CS', 'ECE', 'MATH', 'CSE']
urlpattern = re.compile(r'\b(CS|CSE|MATH|ECE)\s*(\d+)')
newurl = '<a href="https://courses.illinois.edu/cisapp/dispatcher/catalog/2014/fall/%s/%s">%s%s</a>'

def urlify(somestring):
    return urlpattern.sub(newurl%('\g<1>','\g<2>','\g<1>','\g<2>'), somestring)

import yaml
from codecs import open
with open("courses.yml", "rt", encoding="utf-8") as inf:
  courses = yaml.load(inf)
%>

  %for course in courses:
    %if not course["title"]:
    <% continue %>
    %endif
    <h2>${urlify(course["number"])}: ${course["title"]}</h2>

    <p>Offered ${course["frequency"]}.</p>

    %if course.get("description"):
    <p>${urlify(course["description"])}</p>
    %endif

    %if course.get("editions"):
      <ul>
        %for edition in course["editions"]:
          <li>
            %if not edition.get("when"):
              <% continue %>
            %endif
            %if edition.get("url"):
            <a href="${edition["url"]}">${edition["when"]}</a>
            %else:
            ${edition["when"]}
            %endif
            %if edition.get("description"):
              : ${edition["description"]}
            %endif
            %if edition.get("who"):
              (${edition["who"]})
            %endif
          </li>
        %endfor
      </ul>
    %endif
  %endfor
</%block>
